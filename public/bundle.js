!function(t){function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}var e={};n.m=t,n.c=e,n.i=function(t){return t},n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},n.p="",n(n.s=0)}([function(t,n,e){"use strict";function o(t){if(Array.isArray(t)){for(var n=0,e=Array(t.length);n<t.length;n++)e[n]=t[n];return e}return Array.from(t)}e(1);var r=function(){var t=function(){return fetch("https://ytjv79nzl4.execute-api.us-east-1.amazonaws.com/dev/token").then(function(t){return t.json()}).then(function(t){return JSON.parse(t).access_token}).catch(function(t){return console.log("err",t)})},n=function(t,n){return fetch("https://anilist.co/api/user/"+t+"/animelist?access_token="+n).then(function(t){return t.json()}).catch(function(t){return console.log("err",t)})},e=function(t){return[].concat(o(t.lists.completed||[]),o(t.lists.plan_to_watch||[]),o(t.lists.dropped||[]),o(t.lists.on_hold||[]),o(t.lists.watching||[]))},r=function(t){return{episodes_watched:t.episodes_watched,list_status:t.list_status,score:t.score,priority:t.priority,notes:t.notes,title:t.anime.title_romaji}};return{getList:function(o){return t().then(function(t){return n(o,t)}).then(function(t){return e(t)}).then(function(t){return t.map(function(t){return r(t)})}).catch(function(t){return $("#status").append("<li>Unable to fetch Anilist.co list: "+t+"</li>"),console.log(t),t})}}}(),i=function(){var t="",n=function(t,n){return fetch("http://localhost:4000/mal/check",{method:"post",body:JSON.stringify({auth:btoa(t+":"+n)}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(t){return t.json()}).catch(function(t){return console.log("MAL check err",t)})},e=function(n,e){return fetch("http://localhost:4000/mal/add",{method:"post",body:JSON.stringify({auth:t,anilist:e}),headers:{Accept:"application/json","Content-Type":"application/json"}}).then(function(t){return t.json()}).catch(function(t){return console.log("MAL search err",t)})},o=function(t){console.log("display",t)},r=function t(n){if(n.length>0){$("#current").innerHTML=""+(n.length-1);var r=n.slice(),i=r.shift();e(0,i).then(function(n){o(n),t(r)})}};return{sync:function(t){$("#status").innerHTML='Items remaining: <span id="current">'+t.length+'</span>. Errors: <span id="error-count">0</span>.',r(t)},check:function(e,o){return n(e,o).then(function(n){return"Invalid credentials"!==n?(t=btoa(e+":"+o),!0):($("#status").innerHTML="Invalid MAL credentials",!1)})}}}(),c=function(t){t.preventDefault();var n=$("#mal-username").value.trim(),e=$("#mal-password").value.trim();i.check(n,e).then(function(t){if(t){var n=$("#anilist-username").value.trim();r.getList(n).then(function(t){console.log("Mal list",t),t&&i.sync(t)}).catch(function(t){return console.log("err",t)})}}).catch(function(t){return console.log("err",t)})};!function(){$("#credentials").on("submit",c)}()},function(t,n,e){"use strict";window.$=document.querySelector.bind(document),window.$$=document.querySelectorAll.bind(document),Node.prototype.on=window.on=function(t,n){this.addEventListener(t,n)},NodeList.prototype.__proto__=Array.prototype,NodeList.prototype.on=NodeList.prototype.addEventListener=function(t,n){this.forEach(function(e,o){e.on(t,n)})}}]);
//# sourceMappingURL=bundle.js.map